# CardNews AI Generator - 개발 현황

## ✅ Phase 1 (MVP) - 완료

### 핵심 기능
- [x] **소스 입력**
  - [x] URL 링크 입력
  - [x] 다중 URL 입력 (줄바꿈 구분)
  - [x] 텍스트 직접 입력
  - [x] 입력 가시성 개선 (text-gray-900)

- [x] **AI 처리**
  - [x] OpenAI API 통합
  - [x] AI 모델 선택 (4개 모델)
    - [x] GPT-4.1 Nano (기본)
    - [x] GPT-4.1 Mini
    - [x] GPT-5 Nano
    - [x] GPT-5 Mini
  - [x] 텍스트 요약 생성
  - [x] 키워드 자동 추출
  - [x] 추천 카드 수 계산
  - [x] 다국어 지원 (영어/한국어/일본어)

- [x] **카드뉴스 생성**
  - [x] AI 기반 자동 생성
  - [x] JSON 형식 구조화
  - [x] 카드 시작 옵션 (제목/내용 선택)
  - [x] 타입별 카드 (title, content, closing)
  - [x] 다국어 콘텐츠 생성

- [x] **AI 채팅 편집**
  - [x] Function Calling 구현
  - [x] 특정 카드 수정
  - [x] 카드 순서 변경
  - [x] 자연어 전체 수정 (modify_all_content)
    - [x] 톤 변경 (존댓말/반말/전문적/친근하게)
    - [x] 길이 조절 (간결하게/상세하게)
    - [x] 스타일 변경 (스토리텔링/질문형식/리스트)
    - [x] 이모지 추가 등 자유로운 수정

- [x] **UI/UX**
  - [x] Next.js 14 (App Router)
  - [x] Tailwind CSS 스타일링
  - [x] Zustand 상태 관리
  - [x] react-hot-toast 알림
  - [x] OpenAI 연결 상태 표시
  - [x] AI 모델 카드 선택 UI
  - [x] 반응형 디자인

- [x] **Backend**
  - [x] FastAPI 구조
  - [x] Pydantic 모델
  - [x] Web Scraping (newspaper3k, BeautifulSoup)
  - [x] 다중 URL 스크래핑
  - [x] 언어 자동 감지
  - [x] CORS 설정 (Vercel 와일드카드)
  - [x] Firebase Firestore 통합
  - [x] 인메모리 fallback

- [x] **배포**
  - [x] Frontend → Vercel
  - [x] Backend → Render
  - [x] 환경 변수 설정
  - [x] GitHub Actions (자동 배포)

---

## 🚧 Phase 2 (RSS Auto-Generation) - 진행 예정 🆕

### 개요
**RSS 피드를 통해 자동으로 새 게시물을 감지하고 카드뉴스를 생성하는 자동화 시스템 (RSS 전용)**

### 핵심 목표
- ✨ **100% 자동화**: 수동 입력 없이 자동으로 카드뉴스 생성
- 📡 **RSS 전용**: RSS 피드가 있는 사이트만 지원 (빠른 개발)
- 💾 **영구 저장**: 모든 프로젝트를 DB에 저장하고 관리
- 📧 **사용자별 알림**: 대시보드에서 이메일 등록/관리
- 🎯 **RSS 지원 사이트**: Microsoft 블로그 등 RSS 피드 제공 사이트

### 1. 데이터베이스 및 저장소
- [ ] **Firebase Firestore 스키마 설계**
  - [ ] `sites` 컬렉션 (크롤링 사이트 관리)
  - [ ] `projects` 컬렉션 (생성된 카드뉴스 프로젝트)
  - [ ] `crawl_logs` 컬렉션 (크롤링 이력)
  - [ ] `notifications` 컬렉션 (알림 이력)

- [ ] **프로젝트 저장 기능**
  - [ ] 프로젝트 생성 및 자동 저장
  - [ ] 프로젝트 버전 관리
  - [ ] 프로젝트 상태 관리 (초안/검토중/완료)
  - [ ] 프로젝트 메타데이터 (생성일, 수정일, 소스 URL)

### 2. 크롤링 사이트 관리
- [ ] **사이트 등록 UI**
  - [ ] 크롤링 사이트 목록 페이지
  - [ ] 사이트 추가 폼 (URL, RSS URL, 이름, 크롤링 주기)
  - [ ] RSS 피드 유효성 자동 검증
  - [ ] 사이트 수정/삭제 기능
  - [ ] 사이트 활성화/비활성화 토글

- [ ] **기본 등록 사이트 (RSS 지원)**
  - [ ] https://blogs.microsoft.com/ (RSS: /feed/)
  - [ ] https://www.microsoft.com/en-us/security (RSS 확인)
  - [ ] 기타 RSS 지원 기술 블로그

- [ ] **Backend API**
  - [ ] `POST /api/sites` - 사이트 등록 (RSS 필수)
  - [ ] `GET /api/sites` - 사이트 목록 조회
  - [ ] `PUT /api/sites/{site_id}` - 사이트 수정
  - [ ] `DELETE /api/sites/{site_id}` - 사이트 삭제
  - [ ] `GET /api/sites/{site_id}/status` - 크롤링 상태 확인
  - [ ] `POST /api/sites/validate-rss` - RSS URL 유효성 검사

### 3. RSS 기반 자동 크롤링 시스템
- [ ] **RSS 피드 파서**
  - [ ] `feedparser` 라이브러리 통합
  - [ ] RSS 피드 유효성 검증
  - [ ] 새 게시물 자동 감지
  - [ ] 중복 게시물 필터링 (URL 기반)
  - [ ] RSS 메타데이터 추출 (제목, 날짜, 요약)

- [ ] **스케줄러 (APScheduler)**
  - [ ] APScheduler 통합
  - [ ] 사이트별 크롤링 주기 설정 (15분/30분/1시간/3시간)
  - [ ] RSS 파싱 실패 시 재시도 로직 (3회)
  - [ ] 크롤링 이력 로그 저장
  - [ ] 스케줄러 상태 모니터링

### 4. 자동 카드뉴스 생성 파이프라인
- [ ] **자동 생성 워크플로우**
  - [ ] 새 게시물 감지 → 자동 스크래핑
  - [ ] 자동 요약 및 키워드 추출
  - [ ] 자동 카드뉴스 생성 (기본 설정 사용)
  - [ ] DB에 "초안" 상태로 저장
  - [ ] 사용자 이메일 알림 발송

- [ ] **Backend 파이프라인 API**
  - [ ] `POST /api/pipeline/trigger` - 수동 파이프라인 트리거
  - [ ] `GET /api/pipeline/status/{job_id}` - 파이프라인 상태 확인
  - [ ] `GET /api/pipeline/history` - 파이프라인 실행 이력

### 5. 사용자별 이메일 알림 시스템
- [ ] **이메일 등록 및 관리 UI**
  - [ ] 대시보드에 "알림 설정" 메뉴 추가
  - [ ] 이메일 주소 등록/수정/삭제
  - [ ] 여러 이메일 주소 등록 지원 (최대 5개)
  - [ ] 알림 ON/OFF 개별 토글
  - [ ] 알림 수신 테스트 기능

- [ ] **이메일 서비스 통합 (SendGrid)**
  - [ ] SendGrid API 통합
  - [ ] 이메일 템플릿 작성 (HTML)
  - [ ] 알림 타입별 템플릿
    - [ ] 카드뉴스 생성 완료 (프로젝트 링크)
    - [ ] 크롤링 실패 알림
    - [ ] 주간 요약 리포트 (선택사항)

- [ ] **Backend API**
  - [ ] `POST /api/notifications/emails` - 이메일 주소 등록
  - [ ] `GET /api/notifications/emails` - 등록된 이메일 목록
  - [ ] `PUT /api/notifications/emails/{email_id}` - 이메일 수정
  - [ ] `DELETE /api/notifications/emails/{email_id}` - 이메일 삭제
  - [ ] `POST /api/notifications/test` - 테스트 이메일 발송

### 6. 프로젝트 관리 시스템
- [ ] **프로젝트 목록 페이지**
  - [ ] 저장된 프로젝트 전체 목록
  - [ ] 필터링 (상태별, 날짜별, 소스별)
  - [ ] 검색 기능 (제목, 키워드)
  - [ ] 페이지네이션
  - [ ] 썸네일 미리보기

- [ ] **프로젝트 상세 페이지**
  - [ ] 프로젝트 정보 (제목, 소스 URL, 생성일, 상태)
  - [ ] 카드뉴스 미리보기
  - [ ] 수정 모드 진입 (요약 단계/카드 단계 선택)
  - [ ] 버전 히스토리

- [ ] **프로젝트 수정 기능**
  - [ ] **요약 단계로 돌아가기**
    - [ ] 요약문 수정
    - [ ] 키워드 재선택
    - [ ] 카드 수 조정
    - [ ] 재생성 버튼
  - [ ] **카드 단계 수정**
    - [ ] 기존 AI 채팅 기능 활용
    - [ ] 특정 카드 수정
    - [ ] 전체 수정 (자연어)
  - [ ] 수정 후 저장 (새 버전 생성)
  - [ ] "완료" 상태로 변경

- [ ] **프로젝트 삭제**
  - [ ] 소프트 삭제 (archived 상태)
  - [ ] 영구 삭제 옵션

### 7. 메인 대시보드 (4개 메뉴)
- [ ] **1️⃣ 크롤링 사이트 설정**
  - [ ] 등록된 RSS 사이트 목록
  - [ ] 사이트별 크롤링 상태 (마지막 크롤링 시간, 다음 예정 시간)
  - [ ] 새 RSS 사이트 추가 버튼
  - [ ] 사이트별 빠른 수동 크롤링 버튼

- [ ] **2️⃣ 수동 카드뉴스 생성 (Phase 1 기능)**
  - [ ] 기존 Phase 1 UI 그대로 유지
  - [ ] URL/텍스트 입력
  - [ ] 즉시 생성 및 편집

- [ ] **3️⃣ 저장된 프로젝트**
  - [ ] 프로젝트 카드 그리드
  - [ ] 상태별 탭 (초안/검토중/완료)
  - [ ] 최근 프로젝트 우선 표시
  - [ ] "새로 생성됨" 뱃지

- [ ] **4️⃣ 알림 설정** 🆕
  - [ ] 이메일 주소 관리
  - [ ] 알림 ON/OFF 설정
  - [ ] 테스트 이메일 발송

### 8. Backend 추가 개발
- [ ] **Pydantic 모델 확장**
  - [ ] `Site` 모델 (RSS 사이트)
  - [ ] `CrawlLog` 모델 (크롤링 이력)
  - [ ] `EmailRecipient` 모델 (알림 이메일) 🆕
  - [ ] `Notification` 모델 (알림 이력)
  - [ ] `Project` 모델 확장 (버전, 상태, 메타데이터)

- [ ] **새 서비스 구현**
  - [ ] `rss_service.py` - RSS 피드 파싱 (핵심)
  - [ ] `scheduler_service.py` - 스케줄링
  - [ ] `email_service.py` - 이메일 발송
  - [ ] `pipeline_service.py` - 자동 생성 파이프라인

- [ ] **새 라우터 추가**
  - [ ] `sites.py` - RSS 사이트 관리 API
  - [ ] `pipeline.py` - 파이프라인 API
  - [ ] `notifications.py` - 알림 및 이메일 관리 API 🆕

### 9. 외부 라이브러리 추가
- [ ] **Python (Backend)**
  - [ ] `feedparser==6.0.10` - RSS 파싱 (핵심)
  - [ ] `APScheduler==3.10.4` - 스케줄링
  - [ ] `sendgrid==6.11.0` - 이메일 발송
  - [ ] `tenacity==8.2.3` - 재시도 로직

- [ ] **Frontend**
  - [ ] `react-table` - 프로젝트/이메일 목록 테이블 (선택)
  - [ ] `date-fns` - 날짜 포맷팅 (선택)

### 10. 배포 및 인프라
- [ ] **환경 변수 추가**
  - [ ] `SENDGRID_API_KEY`
  - [ ] `DEFAULT_CRAWL_INTERVAL` (기본 크롤링 주기, 예: 30)
  - [ ] `MAX_CONCURRENT_CRAWLS` (기본: 3)
  - [ ] `MAX_EMAIL_RECIPIENTS` (기본: 5)

- [ ] **Render 설정 업데이트**
  - [ ] Background Worker 추가 (스케줄러 실행)
  - [ ] 메모리: 512MB → 1GB (권장)

---

## 🎨 Phase 3 (Web Scraping & Design) - 미래 계획

### 계획된 기능

#### 1. 웹 스크래핑 시스템 (RSS 없는 사이트) 🆕
- [ ] **Playwright 통합**
  - [ ] Playwright 설치 및 설정
  - [ ] JavaScript 렌더링 지원
  - [ ] 헤드리스 브라우저 모드
- [ ] **사이트별 커스텀 크롤링**
  - [ ] 사이트 구조 분석 툴
  - [ ] CSS 셀렉터 설정 UI
  - [ ] 커스텀 스크래핑 로직 저장
- [ ] **RSS 없는 사이트 지원**
  - [ ] Microsoft News Korea (RSS 없을 경우)
  - [ ] 기타 RSS 미지원 사이트
- [ ] **크롤링 타입 선택**
  - [ ] 사이트 등록 시 "RSS" 또는 "웹 스크래핑" 선택
  - [ ] 자동 감지 및 추천

#### 2. 디자인 시스템
- [ ] 디자인 템플릿 라이브러리
  - [ ] 10+ 프리셋 템플릿
  - [ ] 색상 팔레트 선택
  - [ ] 폰트 선택 (한글/영문)
  - [ ] 레이아웃 타입 (중앙/좌/우 정렬)
- [ ] 실시간 미리보기
- [ ] 커스텀 CSS 지원

#### 2. 이미지 생성 및 편집
- [ ] AI 이미지 생성 (DALL-E, Midjourney)
- [ ] 이미지 업로드
- [ ] 이미지 편집 (크롭, 필터, 텍스트 오버레이)
- [ ] Unsplash 연동 (무료 이미지)

#### 3. 카드뉴스 내보내기
- [ ] PNG/JPG 이미지로 내보내기 (카드별)
- [ ] PDF로 내보내기 (전체)
- [ ] 고해상도 옵션
- [ ] SNS 최적화 사이즈 (인스타그램, 페이스북 등)

#### 4. 사용자 인증 및 관리
- [ ] Firebase Authentication
  - [ ] 이메일/비밀번호
  - [ ] Google 로그인
  - [ ] GitHub 로그인
- [ ] 사용자 프로필
- [ ] 팀 협업 기능
- [ ] 권한 관리

#### 5. 고급 기능
- [ ] 버전 히스토리 고도화
- [ ] 협업 기능 (공유, 댓글)
- [ ] 템플릿 마켓플레이스
- [ ] 분석 대시보드 (조회수, 공유수)

---

## 🐛 알려진 이슈 및 개선 사항

### 버그
- 없음 (현재 알려진 버그 없음)

### 개선 예정
- [ ] 카드 생성 속도 최적화 (스트리밍 응답)
- [ ] 더 많은 언어 지원 (중국어, 스페인어, 프랑스어)
- [ ] 고급 언어 감지 라이브러리 (`langdetect`)
- [ ] WebSocket 실시간 채팅
- [ ] 카드 개수 동적 조절 (AI 채팅으로)

---

## 📈 개발 통계

### Phase 1 완료 현황
- **전체 진행률**: 100% ✅
- **핵심 기능**: 8/8 완료
- **배포**: 2/2 완료 (Vercel + Render)

### Phase 2 계획 (RSS 전용)
- **예상 기간**: 3-4주 (1-2주 단축!) 🎯
- **핵심 기능**: RSS 크롤링, 자동 생성, 사용자별 이메일
- **신규 API**: 12+ 엔드포인트
- **타겟 사이트**: RSS 지원 사이트 (Microsoft 블로그 등)

### 코드 통계
- **Backend**: Python, FastAPI, 12개 파일
- **Frontend**: TypeScript, Next.js, 25개+ 컴포넌트
- **테스트**: pytest (백엔드 유닛 테스트)

---

## 🎯 Phase 2 개발 우선순위 (3-4주)

### Week 1: 기반 구축 (7일)
1. Firebase Firestore 스키마 설계 및 구축 (4개 컬렉션)
2. 프로젝트 저장 기능 구현 (CRUD API)
3. 크롤링 사이트 관리 UI 및 API
4. 이메일 등록 UI 및 API 🆕

**체크포인트**:
- [ ] Firestore 스키마 완성
- [ ] 프로젝트 CRUD 동작
- [ ] 사이트 등록 UI 완성
- [ ] 이메일 등록 UI 완성

### Week 2: RSS 크롤링 시스템 (7일)
1. RSS 피드 파서 구현 (`feedparser`)
2. RSS 유효성 검증 로직
3. APScheduler 통합 및 설정
4. Microsoft RSS 사이트 크롤링 테스트

**체크포인트**:
- [ ] RSS 파싱 성공
- [ ] 스케줄러 자동 실행 (30분마다)
- [ ] Microsoft 블로그 크롤링 성공
- [ ] 중복 필터링 동작

### Week 3: 자동화 파이프라인 & 알림 (7일)
1. 자동 생성 파이프라인 구현
2. SendGrid 이메일 통합
3. 사용자별 이메일 발송 로직
4. 프로젝트 관리 시스템 (목록/상세/수정)

**체크포인트**:
- [ ] End-to-End 자동 생성 동작
- [ ] 이메일 발송 성공
- [ ] 프로젝트 목록 조회 가능
- [ ] 프로젝트 수정 가능

### Week 4: UI 통합 & 테스트 (7일)
1. 메인 대시보드 UI (4개 메뉴)
2. 통합 테스트
3. 버그 수정 및 안정화
4. 프로덕션 배포

**체크포인트**:
- [ ] 모든 메뉴 정상 동작
- [ ] RSS 크롤링 성공률 95% 이상
- [ ] 평균 생성 시간 30초 이내
- [ ] 프로덕션 배포 완료
4. 문서화 완료

---

## 📝 최근 업데이트

### 2025-10-26
- ✅ Phase 2 단순화: RSS 전용으로 변경 (개발 기간 단축)
- ✅ Phase 3에 웹 스크래핑 (Playwright) 기능 이동
- ✅ 이메일 알림을 사용자 등록 방식으로 변경
- ✅ 메인 대시보드 4개 메뉴로 확장 (알림 설정 추가)
- ✅ 개발 기간: 4-6주 → 3-4주 단축

---

## 🔗 관련 문서

- **프로젝트 소개**: [README.md](README.md)
- **제품 기획서**: [docs/PRD.md](docs/PRD.md)
- **개발 문서**: [docs/개발문서.md](docs/개발문서.md)
- **Phase 2 개발 정의서**: [PHASE2_SPEC.md](PHASE2_SPEC.md) 📌 신규

---

**Last Updated**: 2025-10-25
